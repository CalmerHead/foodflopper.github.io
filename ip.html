<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>IP</title>
<meta name="referrer" content="same-origin">
<link rel="canonical" href="https://github.com/CalmerHead/foodflopper/blob/main/services/main.go/ip.html">
<meta name="robots" content="max-image-preview:large">
<meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
<style>html,body{-webkit-text-zoom:reset !important}@font-face{font-display:block;font-family:"Muli";src:url('css/Muli-Regular.woff2') format('woff2'),url('css/Muli-Regular.woff') format('woff');font-weight:400}@font-face{font-display:block;font-family:"PT Sans";src:url('css/PT_Sans-Web-Regular.woff2') format('woff2'),url('css/PT_Sans-Web-Regular.woff') format('woff');font-weight:400}@font-face{font-display:block;font-family:"Lato";src:url('css/Lato-Light.woff2') format('woff2'),url('css/Lato-Light.woff') format('woff');font-weight:300}@font-face{font-display:block;font-family:"Lato";src:url('css/Lato-Black.woff2') format('woff2'),url('css/Lato-Black.woff') format('woff');font-weight:900}@font-face{font-display:block;font-family:"Lato";src:url('css/Lato-Regular.woff2') format('woff2'),url('css/Lato-Regular.woff') format('woff');font-weight:400}@font-face{font-display:block;font-family:"Lato";src:url('css/Lato-Bold.woff2') format('woff2'),url('css/Lato-Bold.woff') format('woff');font-weight:700}body>div{font-size:0}p,span,h1,h2,h3,h4,h5,h6,a,li{margin:0;word-spacing:normal;word-wrap:break-word;-ms-word-wrap:break-word;pointer-events:auto;-ms-text-size-adjust:none !important;-moz-text-size-adjust:none !important;-webkit-text-size-adjust:none !important;text-size-adjust:none !important;max-height:10000000px}sup{font-size:inherit;vertical-align:baseline;position:relative;top:-0.4em}sub{font-size:inherit;vertical-align:baseline;position:relative;top:0.4em}ul{display:block;word-spacing:normal;word-wrap:break-word;line-break:normal;list-style-type:none;padding:0;margin:0;-moz-padding-start:0;-khtml-padding-start:0;-webkit-padding-start:0;-o-padding-start:0;-padding-start:0;-webkit-margin-before:0;-webkit-margin-after:0}li{display:block;white-space:normal}[data-marker]::before{content:attr(data-marker) ' ';-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none}li p{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none}form{display:inline-block}a{text-decoration:inherit;color:inherit;-webkit-tap-highlight-color:rgba(0,0,0,0)}textarea{resize:none}.shm-l{float:left;clear:left}.shm-r{float:right;clear:right}.btf{display:none}.plyr{min-width:0 !important}html{font-family:sans-serif}body{font-size:0;margin:0;--z:1;zoom:var(--z)}audio,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background:0 0;outline:0}b,strong{font-weight:700}dfn{font-style:italic}h1,h2,h3,h4,h5,h6{font-size:1em;line-height:1;margin:0}img{border:0}svg:not(:root){overflow:hidden}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=submit]{-webkit-appearance:button;cursor:pointer;box-sizing:border-box;white-space:normal}input[type=date],input[type=email],input[type=number],input[type=password],input[type=text],textarea{-webkit-appearance:none;appearance:none;box-sizing:border-box}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}textarea{overflow:auto;box-sizing:border-box;border-color:#ddd}optgroup{font-weight:700}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}blockquote{margin-block-start:0;margin-block-end:0;margin-inline-start:0;margin-inline-end:0}:-webkit-full-screen-ancestor:not(iframe){-webkit-clip-path:initial !important}
html{-webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale}#b{background-color:#fff}.ps110{position:relative;margin-top:0}.v13{display:block;vertical-align:top}.s103{width:1200px;margin-left:auto;margin-right:auto;min-height:5524px}.z96{pointer-events:none}.v14{display:inline-block;vertical-align:top}.ps111{position:relative;margin-left:0;margin-top:0}.s104{min-width:1200px;width:1200px;overflow:hidden;height:95px}.z97{pointer-events:auto}.p10{text-indent:0;padding-bottom:0;padding-right:0;text-align:center}.f29{font-family:Muli;font-size:49px;font-size:calc(49px * var(--f));line-height:1.777;font-weight:400;font-style:normal;text-decoration:none;text-transform:none;letter-spacing:normal;color:#000;background-color:initial;text-shadow:none}.ps112{position:relative;margin-left:0;margin-top:0}.s105{min-width:1200px;width:1200px;min-height:689px}.s106{min-width:600px;width:600px;min-height:689px;line-height:0}.s107{min-width:600px;width:600px;min-height:333px;height:333px}.z98{z-index:4;pointer-events:auto}.i10{position:absolute;left:0;width:600px;height:333px;top:0;border:0}.ps113{position:relative;margin-left:0;margin-top:-2px}.s108{min-width:600px;width:600px;min-height:358px;height:358px}.z99{z-index:6;pointer-events:auto}.i11{position:absolute;left:0;width:600px;height:358px;top:0;border:0}.s109{min-width:600px;width:600px;min-height:611px;line-height:0}.i12{position:absolute;left:0;width:599px;height:333px;top:0;border:0}.ps114{position:relative;margin-left:0;margin-top:98px}.s110{min-width:600px;width:600px;overflow:hidden;height:180px}.f30{font-family:Muli;font-size:20px;font-size:calc(20px * var(--f));line-height:1.801;font-weight:400;font-style:normal;text-decoration:none;text-transform:none;letter-spacing:normal;color:#000;background-color:initial;text-shadow:none}.ps115{position:relative;margin-left:0;margin-top:34px}.ps116{position:relative;margin-left:291px;margin-top:0}.s111{min-width:600px;width:600px;min-height:334px;height:334px}.i13{position:absolute;left:0;width:600px;height:334px;top:0;border:0}.ps117{position:relative;margin-left:0;margin-top:3px}.s112{min-width:1200px;width:1200px;overflow:hidden;height:4179px}.p11{text-indent:0;padding-bottom:0;padding-right:0;text-align:left}.f31{font-family:Arial, Helvetica, sans-serif;font-size:13px;font-size:calc(13px * var(--f));line-height:1.616;font-weight:400;font-style:normal;text-decoration:none;text-transform:none;letter-spacing:normal;color:#000;background-color:initial;text-shadow:none}body{--d:0;--s:1200}@media (max-width:1199px) {.s103{width:320px;min-height:1473px}.s104{min-width:320px;width:320px;height:25px}.f29{font-size:13px;font-size:calc(13px * var(--f));line-height:1.770}.ps112{margin-top:1px}.s105{min-width:320px;width:320px;min-height:183px}.s106{min-width:160px;width:160px;min-height:183px}.s107{min-width:160px;width:160px;min-height:89px;height:89px}.i10{width:160px;height:89px}.ps113{margin-top:-1px}.s108{min-width:160px;width:160px;min-height:95px;height:95px}.i11{width:159px;height:95px}.s109{min-width:160px;width:160px;min-height:163px}.i12{width:160px;height:89px}.ps114{margin-top:26px}.s110{min-width:160px;width:160px;height:48px}.f30{font-size:5px;font-size:calc(5px * var(--f))}.ps115{margin-top:9px}.ps116{margin-left:78px;margin-top:1px}.s111{min-width:160px;width:160px;min-height:89px;height:89px}.i13{width:160px;height:89px}.ps117{margin-top:1px}.s112{min-width:320px;width:320px;height:1114px}.f31{font-size:3px;font-size:calc(3px * var(--f));line-height:1.668}body{--d:1;--s:320}}</style>
<link onload="this.media='all';this.onload=null;" rel="stylesheet" href="css/site.9f31c2.css" media="print">
</head>
<body id="b">
<script>var p=document.createElement("P");p.innerHTML="&nbsp;",p.style.cssText="position:fixed;visible:hidden;font-size:100px;zoom:1",document.body.appendChild(p);var rsz=function(e){return function(){var r=Math.trunc(1e3/parseFloat(window.getComputedStyle(e).getPropertyValue("font-size")))/10,t=document.body;r!=t.style.getPropertyValue("--f")&&t.style.setProperty("--f",r)}}(p);if("ResizeObserver"in window){var ro=new ResizeObserver(rsz);ro.observe(p)}else if("requestAnimationFrame"in window){var raf=function(){rsz(),requestAnimationFrame(raf)};requestAnimationFrame(raf)}else setInterval(rsz,100);</script>

<script>!function(){var e=function(){var e=document.body;e.style.setProperty("--z",1);var t=window.innerWidth,n=getComputedStyle(e).getPropertyValue("--s");if(320==n){if(t<320)return;t=Math.min(479,t)}else if(480==n){if(t<480)return;t=Math.min(610,t)}else t=n;e.style.setProperty("--z",Math.trunc(t/n*1e3)/1e3)};window.addEventListener?window.addEventListener("resize",e,!0):window.onscroll=e,e()}();</script>

<div class="ps110 v13 s103 z96">
<div class="v14 ps111 s104 c30 z97">
<p class="p10 f29">Intellectual Proprety</p>
</div>
<div class="v14 ps111 s104 c30 z97">
<p class="p10 f29">GUI</p>
</div>
<div class="v14 ps112 s105">
<div class="v14 ps111 s106">
<div class="v14 ps111 s107 c30 z98">
<picture>
<source srcset="images/pasted-image-320.webp 2x" type="image/webp" media="(max-width:1199px)">
<source srcset="images/pasted-image-320.png 2x" media="(max-width:1199px)">
<source srcset="images/pasted-image-600.webp 1x, images/pasted-image-1200.webp 2x" type="image/webp" media="(min-width:1200px)">
<source srcset="images/pasted-image-600.png 1x, images/pasted-image-1200.png 2x" media="(min-width:1200px)">
<img src="images/pasted-image-1200.png" class="i10">
</picture>
</div>
<div class="v14 ps113 s108 c30 z99">
<picture>
<source srcset="images/pasted-image-318.webp 2x" type="image/webp" media="(max-width:1199px)">
<source srcset="images/pasted-image-318.png 2x" media="(max-width:1199px)">
<source srcset="images/pasted-image-600-1.webp 1x, images/pasted-image-1200-1.webp 2x" type="image/webp" media="(min-width:1200px)">
<source srcset="images/pasted-image-600-1.png 1x, images/pasted-image-1200-1.png 2x" media="(min-width:1200px)">
<img src="images/pasted-image-1200-1.png" class="i11">
</picture>
</div>
</div>
<div class="v14 ps111 s109">
<div class="v14 ps111 s107 c30 z97">
<picture>
<source srcset="images/pasted-image-320-1.webp 2x" type="image/webp" media="(max-width:1199px)">
<source srcset="images/pasted-image-320-1.png 2x" media="(max-width:1199px)">
<source srcset="images/pasted-image-599.webp 1x, images/pasted-image-1198.webp 2x" type="image/webp" media="(min-width:1200px)">
<source srcset="images/pasted-image-599.png 1x, images/pasted-image-1198.png 2x" media="(min-width:1200px)">
<img src="images/pasted-image-1198.png" class="i12">
</picture>
</div>
<div class="v14 ps114 s110 c30 z97">
<p class="p10 f30">To Comment<br><br>https://docs.google.com/presentation/d/1iemBYF-hGidv5LCbfI_MQgvqXaRQ3_8X9u718fINSW0/edit?usp=sharing</p>
</div>
</div>
</div>
<div class="v14 ps115 s104 c30 z97">
<p class="p10 f29">Back End</p>
</div>
<div class="v14 ps116 s111 c30 z97">
<picture>
<source srcset="images/pasted-image-320-2.webp 2x" type="image/webp" media="(max-width:1199px)">
<source srcset="images/pasted-image-320-2.png 2x" media="(max-width:1199px)">
<source srcset="images/pasted-image-600-2.webp 1x, images/pasted-image-1200-2.webp 2x" type="image/webp" media="(min-width:1200px)">
<source srcset="images/pasted-image-600-2.png 1x, images/pasted-image-1200-2.png 2x" media="(min-width:1200px)">
<img src="images/pasted-image-1200-2.png" class="i13">
</picture>
</div>
<div class="v14 ps117 s112 c30 z97">
<p class="p11 f31">==== visual.sh ====</p>
<p class="p11 f31">ffmpeg -y -rtsp_transport tcp -i rtsp://viewer:R4raoolala@192.168.1.225/live -vframes 1 do.jpg<br><br>==== main.go ====<br>package main</p>
<p class="p11 f31"><br></p>
<p class="p11 f31">import (</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&quot;database/sql&quot;</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&quot;encoding/json&quot;</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&quot;fmt&quot;</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&quot;io&quot;</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&quot;net/http&quot;</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&quot;strconv&quot;</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&quot;time&quot;</p>
<p class="p11 f31"><br></p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;_ &quot;github.com/mattn/go-sqlite3&quot;</p>
<p class="p11 f31">)</p>
<p class="p11 f31"><br></p>
<p class="p11 f31">type MealsRepository struct {</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;db *sql.DB</p>
<p class="p11 f31">}</p>
<p class="p11 f31"><br></p>
<p class="p11 f31">type MealLog []Meal</p>
<p class="p11 f31">type Meal struct {</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;Name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;Time&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; time.Time</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;Calories&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int64</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;Protein, Fat, Carbs&nbsp;&nbsp;int //grams</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;VitaminA, VitaminB12 int //grams</p>
<p class="p11 f31">}</p>
<p class="p11 f31"><br></p>
<p class="p11 f31">const file string = &quot;meallog.db&quot;</p>
<p class="p11 f31">const create string = `</p>
<p class="p11 f31">&nbsp;&nbsp;CREATE TABLE IF NOT EXISTS meallog (</p>
<p class="p11 f31">&nbsp;&nbsp;id INTEGER NOT NULL PRIMARY KEY,</p>
<p class="p11 f31">&nbsp;&nbsp;name TEXT,</p>
<p class="p11 f31">&nbsp;&nbsp;calories INTEGER,</p>
<p class="p11 f31">&nbsp;&nbsp;protein INTEGER,</p>
<p class="p11 f31">&nbsp;&nbsp;fat INTEGER,</p>
<p class="p11 f31">&nbsp;&nbsp;carbs INTEGER,</p>
<p class="p11 f31">&nbsp;&nbsp;vitaminA INTEGER,</p>
<p class="p11 f31">&nbsp;&nbsp;vitaminB INTEGER,</p>
<p class="p11 f31">&nbsp;&nbsp;time DATETIME NOT NULL</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;);`</p>
<p class="p11 f31"><br></p>
<p class="p11 f31">func NewMealLog() (*MealsRepository, error) {</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;db, err := sql.Open(&quot;sqlite3&quot;, file)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;if err != nil {</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return nil, err</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;if _, err := db.Exec(create); err != nil {</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return nil, err</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;return &amp;MealsRepository{</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;db: db,</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;}, nil</p>
<p class="p11 f31">}</p>
<p class="p11 f31"><br></p>
<p class="p11 f31">func (c *MealsRepository) Insert(m Meal) (int, error) {</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;res, err := c.db.Exec(&quot;INSERT INTO meallog VALUES(NULL,?,?,?,?,?,?,?,?);&quot;,</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m.Name,</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m.Calories,</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m.Protein,</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m.Fat,</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m.Carbs,</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m.VitaminA,</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m.VitaminB12,</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m.Time,</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;if err != nil {</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 0, err</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p class="p11 f31"><br></p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;var id int64</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;if id, err = res.LastInsertId(); err != nil {</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 0, err</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;return int(id), nil</p>
<p class="p11 f31">}</p>
<p class="p11 f31"><br></p>
<p class="p11 f31">var mr, dberr = NewMealLog()</p>
<p class="p11 f31"><br></p>
<p class="p11 f31">func getMeal(w http.ResponseWriter, r *http.Request) {</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;fmt.Printf(&quot;/getMeal request\n&quot;)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;id_string := r.Header.Get(&quot;mealid&quot;)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;id, err := strconv.Atoi(id_string)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;if err != nil {</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.WriteString(w, &quot;err: provide mealid header key/val&quot;)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;row := mr.db.QueryRow(&quot;SELECT * FROM meallog WHERE id=?&quot;, id)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;mret := Meal{ID: id}</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;err = row.Scan(&amp;mret.ID, &amp;mret.Name, &amp;mret.Calories, &amp;mret.Protein, &amp;mret.Fat, &amp;mret.Carbs, &amp;mret.VitaminA, &amp;mret.VitaminB12, &amp;mret.Time)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;if err != nil {</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panic(err)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;b, _ := json.Marshal(mret)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;io.WriteString(w, string(b)+&quot;\n&quot;)</p>
<p class="p11 f31">}</p>
<p class="p11 f31"><br></p>
<p class="p11 f31">func getMeals(w http.ResponseWriter, r *http.Request) {</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;meals := make([]Meal, 0)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;var mret Meal</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;fmt.Printf(&quot;/getmeals request\n&quot;)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;rows, err := mr.db.Query(&quot;SELECT * FROM meallog&quot;)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;if err != nil {</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panic(err)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;defer rows.Close()</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;for rows.Next() {</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err = rows.Scan(&amp;mret.ID, &amp;mret.Name, &amp;mret.Calories, &amp;mret.Protein, &amp;mret.Fat, &amp;mret.Carbs, &amp;mret.VitaminA, &amp;mret.VitaminB12, &amp;mret.Time)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if err != nil {</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panic(err)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;meals = append(meals, mret)</p>
<p class="p11 f31"><br></p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p class="p11 f31"><br></p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;b, _ := json.Marshal(meals)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;io.WriteString(w, string(b)+&quot;\n&quot;)</p>
<p class="p11 f31">}</p>
<p class="p11 f31"><br></p>
<p class="p11 f31">func addMeal(w http.ResponseWriter, r *http.Request) {</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;var m = &amp;Meal{}</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;b, err := io.ReadAll(r.Body)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;if err != nil {</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panic(err)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;err = json.Unmarshal(b, m)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;if err != nil {</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panic(err)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;id, err := mr.Insert(*m)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;if err != nil {</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panic(err)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;st := fmt.Sprintf(&quot;inserted meal! id = %d\n&quot;, id)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;io.WriteString(w, st)</p>
<p class="p11 f31"><br></p>
<p class="p11 f31">}</p>
<p class="p11 f31"><br></p>
<p class="p11 f31">func deleteMeal(w http.ResponseWriter, r *http.Request) {</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;fmt.Printf(&quot;/deleteMeal request\n&quot;)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;id_string := r.Header.Get(&quot;mealid&quot;)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;id, err := strconv.Atoi(id_string)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;if err != nil {</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.WriteString(w, &quot;err: provide mealid header key/val&quot;)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;_, err = mr.db.Exec(&quot;DELETE FROM meallog WHERE id=?&quot;, id)</p>
<p class="p11 f31"><br></p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;if err == nil {</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;io.WriteString(w, &quot;success\n&quot;)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;io.WriteString(w, fmt.Sprintf(&quot;error:%s\n&quot;, err))</p>
<p class="p11 f31">}</p>
<p class="p11 f31"><br></p>
<p class="p11 f31">func main() {</p>
<p class="p11 f31"><br></p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;// var m Meal = Meal{</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp; Calories:&nbsp;&nbsp; 800,</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp; Protein:&nbsp;&nbsp;&nbsp;&nbsp;27,</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp; Fat:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20,</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp; Carbs:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp; VitaminA:&nbsp;&nbsp; 0,</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp; VitaminB12: 0,</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp; Time:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; time.Now(),</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;// }</p>
<p class="p11 f31"><br></p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;// id, err := mr.Insert(m)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;// if err != nil {</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp; panic(err)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;// }</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;// fmt.Printf(&quot;inserted meal! id = %d\n&quot;, id)</p>
<p class="p11 f31"><br></p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;// row := mr.db.QueryRow(&quot;SELECT * FROM meallog WHERE id=?&quot;, id)</p>
<p class="p11 f31"><br></p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;// mret := Meal{ID: id}</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;// err = row.Scan(&amp;mret.ID, &amp;mret.Name, &amp;mret.Calories, &amp;mret.Protein, &amp;mret.Fat, &amp;mret.Carbs, &amp;mret.VitaminA, &amp;mret.VitaminB12, &amp;mret.Time)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;// if err != nil {</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp; panic(err)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;// }</p>
<p class="p11 f31"><br></p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;// fmt.Printf(&quot;%#v\n&quot;, mret)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;http.HandleFunc(&quot;/getMeal&quot;, getMeal)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;http.HandleFunc(&quot;/getMeals&quot;, getMeals)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;http.HandleFunc(&quot;/addMeal&quot;, addMeal)</p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;http.HandleFunc(&quot;/deleteMeal&quot;, deleteMeal)</p>
<p class="p11 f31"><br></p>
<p class="p11 f31">&nbsp;&nbsp;&nbsp;&nbsp;http.ListenAndServe(&quot;:3333&quot;, nil)</p>
<p class="p11 f31">}</p>
</div>
</div>
<div class="btf c14">
</div>
<script>var lwi=-1;function thresholdPassed(){var w=document.documentElement.clientWidth;var p=false;var cw=0;if(w>=1200){cw++;}if(lwi!=cw){p=true;}lwi=cw;return p;}!function(){if("Promise"in window&&void 0!==window.performance){var e,t,r=document,n=function(){return r.createElement("link")},o=new Set,a=n(),i=a.relList&&a.relList.supports&&a.relList.supports("prefetch"),s=location.href.replace(/#[^#]+$/,"");o.add(s);var c=function(e){var t=location,r="http:",n="https:";if(e&&e.href&&e.origin==t.origin&&[r,n].includes(e.protocol)&&(e.protocol!=r||t.protocol!=n)){var o=e.pathname;if(!(e.hash&&o+e.search==t.pathname+t.search||"?preload=no"==e.search.substr(-11)||".html"!=o.substr(-5)&&".html"!=o.substr(-5)&&"/"!=o.substr(-1)))return!0}},u=function(e){var t=e.replace(/#[^#]+$/,"");if(!o.has(t)){if(i){var a=n();a.rel="prefetch",a.href=t,r.head.appendChild(a)}else{var s=new XMLHttpRequest;s.open("GET",t,s.withCredentials=!0),s.send()}o.add(t)}},p=function(e){return e.target.closest("a")},f=function(t){var r=t.relatedTarget;r&&p(t)==r.closest("a")||e&&(clearTimeout(e),e=void 0)},d={capture:!0,passive:!0};r.addEventListener("touchstart",function(e){t=performance.now();var r=p(e);c(r)&&u(r.href)},d),r.addEventListener("mouseover",function(r){if(!(performance.now()-t<1200)){var n=p(r);c(n)&&(n.addEventListener("mouseout",f,{passive:!0}),e=setTimeout(function(){u(n.href),e=void 0},80))}},d)}}();dpth="/";!function(){var e={},t={},n={};window.ld=function(a,o,c){var d=function(){"interactive"==document.readyState?(o&&o(),document.addEventListener("readystatechange",function(){"complete"==document.readyState&&c&&c()})):"complete"==document.readyState?(o&&o(),c&&c()):document.addEventListener("readystatechange",function(){"interactive"==document.readyState&&o&&o(),"complete"==document.readyState&&c&&c()})},r=(1<<a.length)-1,i=0,u=function(o){var c=a[o],u=function(){for(var t=0;t<a.length;t++){var o=(1<<t)-1;if((i&o)==o&&n[a[t]]){if(!e[a[t]]){var c=document.createElement("script");c.textContent=n[a[t]],document.body.appendChild(c),e[a[t]]=!0}(i|=1<<t)==r&&d()}}};if(null==t[c]){t[c]=[];var l=new XMLHttpRequest;l.open("GET",c,!0),l.onload=function(){n[c]=l.responseText,[].forEach.call(t[c],function(e){e()})},t[c].push(u),l.send()}else e[c]?u():t[c].push(u)};if(a.length)for(var l=0;l<a.length;l++)u(l);else d()}}();ld([],function(){if(location.hash){var e=location.hash.replace("#",""),o=function(){var t=document.querySelectorAll('[name="'+e+'"]')[0];t&&t.scrollIntoView(),"0px"===window.getComputedStyle(document.body).getPropertyValue("min-width")&&setTimeout(o,100)};o()}});</script>
</body>
</html>